# Moana - AI 原生幼儿启蒙教育内容系统

> 设计文档 | 创建日期：2025-12-05

## 1. 项目概述

### 1.1 产品定位

**Moana** 是一款 AI 原生的幼儿启蒙内容系统，为 1-4 岁儿童提供体系化、多模态的教育内容。

### 1.2 核心问题

- **内容质量不可控**：短视频平台算法推荐的内容良莠不齐
- **缺乏体系化**：碎片化视频无法形成系统的启蒙教育路径

### 1.3 解决方案

基于 LLM 和生成式 AI 技术，提供**定制化、成体系、高质量**的多模态教育内容：
- 绘本（图文故事）
- 儿歌（音频）
- 短视频（动画）

### 1.4 核心设计理念

1. **主题驱动，非算法推荐**：每周围绕一个教育主题展开，三种形态相互呼应
2. **家长掌控，AI 辅助**：家长设定目标，AI 规划执行，新内容需审核
3. **渐进式内容积累**：初期聚合优质内容，逐步过渡到 AI 原创

---

## 2. 技术栈

### 2.1 后端核心

| 组件 | 选型 | 理由 |
|------|------|------|
| Web 框架 | FastAPI | 异步性能好、自动 API 文档、类型提示友好 |
| Agent 框架 | LangChain | Function Calling 成熟、多模型支持 |
| 任务队列 | Celery + Redis | 处理耗时的 AI 生成任务 |
| 数据库 | PostgreSQL | 存储用户数据、内容元信息、课程计划 |
| 对象存储 | 腾讯云 COS | 存储生成的图片、音频、视频文件 |
| 缓存 | Redis | 会话状态、热点内容缓存 |

### 2.2 AI 服务

| 能力 | 选型 | 备选 |
|------|------|------|
| LLM（规划/文案） | Gemini 2.5 Pro | GPT-4o、DeepSeek |
| 图像生成 | Imagen 3 (Banana.dev) | Flux Pro、DALL·E 3 |
| 音乐/儿歌生成 | Suno API | Udio |
| 视频生成 | Kling AI | Runway Gen-3、Luma |
| 语音合成（旁白） | 腾讯云 TTS | Azure TTS |

### 2.3 前端

| 端 | 选型 | 理由 |
|------|------|------|
| 家长端 | 微信小程序 | 用户习惯、推送能力、无需安装 |
| 孩子端 | H5 (Vue3) | 全屏沉浸体验、iPad/手机通用 |

---

## 3. 系统架构

### 3.1 单体 Agent 架构

```
┌─────────────────────────────────────────┐
│           Master Agent (LLM)            │
│  负责：主题规划、内容编排、质量把控          │
└─────────────────┬───────────────────────┘
                  │ 调度
    ┌─────────────┼─────────────┐
    ▼             ▼             ▼
┌───────┐    ┌───────┐    ┌───────┐
│绘本生成│    │儿歌生成│    │视频生成│
│模块    │    │模块    │    │模块    │
└───────┘    └───────┘    └───────┘
```

### 3.2 Master Agent 工作流

```
每周一触发
    │
    ▼
Step 1: 主题规划
    输入：孩子月龄、已完成主题、家长偏好
    输出：本周主题 + 子目标列表
    │
    ▼
Step 2: 内容检索
    优先从「可信内容库」检索
    若不足 → 触发 AI 生成（异步）
    │
    ▼
Step 3: 内容审核流
    AI 生成内容 → status: pending → 推送家长审核
    家长通过 → is_trusted: true → 进入可信库
    │
    ▼
Step 4: 每日推送
    从本周内容池中按顺序编排每日内容
```

---

## 4. 数据模型

### 4.1 核心实体

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   Child     │────▶│ WeeklyPlan  │────▶│   Theme     │
│   孩子档案   │     │   周计划     │     │   主题库    │
└─────────────┘     └─────────────┘     └─────────────┘
                          │
         ┌────────────────┼────────────────┐
         ▼                ▼                ▼
   ┌──────────┐    ┌──────────┐    ┌──────────┐
   │PictureBook│   │   Song   │    │  Video   │
   │   绘本    │    │   儿歌   │    │   视频   │
   └──────────┘    └──────────┘    └──────────┘
```

### 4.2 关键字段

**Child（孩子档案）**
- `birth_date`: 生日，用于计算月龄
- `preferences`: 兴趣偏好
- `completed_themes`: 已学主题记录

**Content（内容基类）**
- `source`: 内容来源（aggregated / ai_generated）
- `status`: 状态（pending / approved / rejected）
- `is_trusted`: 是否进入可信库

**Theme（主题库）**
- `category`: 分类（认知/语言/习惯/情绪/艺术）
- `age_range`: 适用月龄范围
- `keywords`: 关键词

---

## 5. 内容生成模块

### 5.1 绘本生成

```
输入：主题 + 子目标 + 孩子月龄
    │
    ▼
Gemini: 生成故事大纲（5-8 页，每页 < 20 字）
    │
    ▼
Gemini: 生成图像 Prompt（统一画风 + 角色一致性）
    │
    ▼
Imagen 3: 批量生成插图（每页 2-3 张备选）
    │
    ▼
腾讯云 TTS: 生成旁白音频
    │
    ▼
输出：绘本 JSON（页面数组 + 图片URL + 音频URL）
```

### 5.2 儿歌生成

```
输入：主题 + 关键词 + 情绪基调
    │
    ▼
Gemini: 生成歌词（简单押韵，2-3 段）
    │
    ▼
Suno API: 生成完整儿歌（60-90 秒，2 个版本）
    │
    ▼
输出：儿歌 MP3 + 歌词 LRC
```

### 5.3 视频生成

```
输入：主题 + 绘本内容
    │
    ▼
Gemini: 生成分镜脚本（4-6 个镜头）
    │
    ▼
Kling AI: 生成视频片段（每镜头 5 秒）
    │
    ▼
FFmpeg: 拼接 + 配音 + 字幕
    │
    ▼
输出：完整视频 MP4（30-60秒）
```

---

## 6. 前端设计

### 6.1 家长端（微信小程序）

**核心页面：**
- **首页**：本周主题、今日内容预览、快捷操作
- **内容审核页**：待审核列表、预览、通过/拒绝
- **课程设置页**：孩子档案、兴趣偏好、主题定制
- **内容库页**：可信内容库、筛选、手动添加

### 6.2 孩子端（H5）

**设计原则：**
- 极简交互，大按钮、大图标
- 无文字导航，纯图形化
- 自动播放，减少操作需求

**播放模式：**
- 绘本：左右滑动翻页 + 自动朗读
- 儿歌/视频：全屏播放 + 自动循环

---

## 7. 安全与质量控制

### 7.1 三层防护体系

1. **生成时防护（Prompt 层）**
   - System Prompt 内置安全约束
   - 禁止暴力、恐怖、负面情绪
   - 强制正向引导、温暖色调

2. **生成后 AI 审核**
   - Gemini 对生成内容进行安全评估
   - 输出安全分数（0-100）+ 风险标签
   - 低于 80 分自动标记「待审核」

3. **家长人工审核**
   - 所有 AI 生成内容默认需审核
   - 审核通过后进入可信库

### 7.2 内容质量标准

| 维度 | 标准 |
|------|------|
| 适龄性 | 符合 18-48 月龄认知水平 |
| 教育性 | 包含明确的学习目标 |
| 一致性 | 角色形象/画风统一 |
| 时长 | 绘本 5-8 页，视频 30-60 秒 |
| 语言 | 简单句，每句 < 15 字 |

---

## 8. 部署架构

### 8.1 整体架构

```
┌─────────────────┐     ┌─────────────────┐
│  微信小程序      │     │    H5 页面      │
│  (家长端)        │     │   (孩子端)      │
└────────┬────────┘     └────────┬────────┘
         │                       │
         └───────────┬───────────┘
                     ▼
┌─────────────────────────────────────────┐
│            腾讯云服务器                   │
│  ┌─────────────────────────────────┐   │
│  │  Nginx (反向代理)                │   │
│  └─────────────────────────────────┘   │
│       │           │           │        │
│  ┌────┴───┐ ┌─────┴────┐ ┌────┴───┐   │
│  │FastAPI │ │ Celery   │ │ Redis  │   │
│  └────────┘ └──────────┘ └────────┘   │
│                   │                    │
│           ┌───────┴───────┐           │
│           │  PostgreSQL   │           │
│           └───────────────┘           │
└─────────────────────────────────────────┘
         │
         │ API 调用
         ▼
┌─────────────────────────────────────────┐
│  外部服务                                │
│  Gemini | Imagen 3 | Suno | Kling      │
│  腾讯云 COS | 腾讯云 TTS                 │
└─────────────────────────────────────────┘
```

### 8.2 服务器配置

| 组件 | 推荐配置 |
|------|----------|
| CPU | 4 核 |
| 内存 | 8 GB |
| 存储 | 100 GB SSD |
| 带宽 | 10 Mbps |

### 8.3 Docker Compose 部署

```yaml
services:
  api:
    image: moana-api:latest
    ports:
      - "8000:8000"
    depends_on:
      - redis
      - postgres

  celery:
    image: moana-api:latest
    command: celery -A app.celery worker

  celery-beat:
    image: moana-api:latest
    command: celery -A app.celery beat

  redis:
    image: redis:7-alpine

  postgres:
    image: postgres:15
```

---

## 9. MVP 范围

### 9.1 包含功能

| 模块 | MVP 功能 |
|------|----------|
| 家长端 | 孩子档案、主题偏好、内容审核、今日内容 |
| 孩子端 | 绘本阅读、儿歌播放、视频播放 |
| Agent | 周主题生成、内容编排 |
| 绘本生成 | 故事 + 图片 + TTS |
| 儿歌生成 | 歌词 + Suno 音频 |
| 视频生成 | 分镜 + Kling + FFmpeg |
| 内容聚合 | 手动上传/添加链接 |

### 9.2 不包含（后续迭代）

- 自动爬取聚合外部内容
- 多孩子档案支持
- 学习数据分析报告
- 社区分享功能
- 智能音箱对接

---

## 10. 开发计划

```
Phase 1: 基础框架（1-2 周）
├── 项目骨架搭建
├── 数据模型实现
├── 腾讯云 COS / TTS 对接
└── Docker 部署配置

Phase 2: 内容生成能力（2-3 周）
├── Gemini API 对接
├── Imagen 3 对接
├── Suno API 对接
├── Kling API 对接
└── FFmpeg 视频拼接

Phase 3: Agent 与工作流（1-2 周）
├── Master Agent 实现
├── 周计划生成逻辑
├── 可信库检索与编排
└── 定时任务配置

Phase 4: 前端开发（2-3 周）
├── 家长端小程序
├── 孩子端 H5
└── 联调测试

Phase 5: 上线与优化（1 周）
├── 安全审核
├── 性能优化
└── 反馈迭代
```

---

## 11. 成本预估

| 项目 | 预估费用（月） |
|------|----------------|
| 腾讯云服务器（4核8G） | ¥200-300 |
| 腾讯云 COS + CDN | ¥50-100 |
| Gemini API | ¥100-200 |
| Imagen 3 (Banana.dev) | ¥200-400 |
| Suno API | ¥100-200 |
| Kling AI | ¥200-400 |
| **合计** | **¥850-1600/月** |

> 以每周生成 1 套完整主题内容估算。可信库积累后成本会下降。

---

## 12. 决策记录

| 决策项 | 结论 | 理由 |
|--------|------|------|
| 架构模式 | 单体 Agent | 用户规模小，优先验证价值 |
| 内容形态 | 三种联动 | 强化主题记忆 |
| 内容策略 | 聚合 + 生成混合 | 快速启动 + 长期原创 |
| 自动化程度 | 混合模式 | 效率与控制权平衡 |
| 前端分离 | 小程序 + H5 | 各取所长 |
